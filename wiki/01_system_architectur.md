# Архитектура системы «Умная премия»

## 1. Общая концепция

ИС «Умная премия» построена по **клиент-серверной архитектуре** с отдельными компонентами для фронтенда, бэкенда, базы данных и интеграции с Telegram Mini App.
Система должна обеспечивать:

* Единое место хранения данных и логики подсчёта рейтингов.
* Простую интеграцию с Telegram и веб-интерфейсом.
* Масштабируемость и отказоустойчивость.
* Безопасность и разграничение прав доступа.

---

## 2. Компоненты системы

| Компонент                         | Описание                                                                     | Технологии                                |
| --------------------------------- | ---------------------------------------------------------------------------- | ----------------------------------------- |
| **Frontend (сотрудник)**          | Интерфейс голосования через Telegram Mini App и веб-браузер                  | Vue 3, Telegram WebApp SDK, TailwindCSS   |
| **Frontend (админ)**              | Панель управления участниками, неделями голосования, экспорт результатов     | Vue 3, TailwindCSS                        |
| **Backend**                       | API для фронтенда, логика подсчёта рейтингов, аутентификация, хранение логов | Python 3.11, Flask/FastAPI, SQLAlchemy    |
| **База данных**                   | Хранение пользователей, голосов, сессий, настроек                            | SQLite                                    |
| **Кэш / очередь** *(опционально)* | Быстрая обработка голосов и уведомлений                                      | Redis                                     |
| **Сервисы интеграции**            | Telegram Mini App, уведомления, экспорт XLSX/CSV                             | Telegram WebApp API, Celery (опционально) |
| **Инфраструктура**                | Контейнеризация, веб-сервер, CI/CD                                           | Docker, Nginx, GitHub Actions/GitLab CI   |

---

## 3. Схема взаимодействия

1. **Сотрудник** открывает Telegram Mini App или веб-страницу → фронтенд отображает форму голосования.
2. **Фронтенд** отправляет оценки на **Backend API** через HTTP.
3. **Backend**:

   * Проверяет валидность пользователя (Telegram initData или SSO).
   * Сохраняет голос в базу данных.
   * Логирует действия пользователя.
4. **База данных** хранит все оценки, сессии голосования, настройки и логи.
5. **Backend** агрегирует оценки для формирования рейтингов и предоставляет их фронтенду для отображения.
6. **Админ** использует панель управления для:

   * запуска/закрытия сессий,
   * управления списком активных сотрудников,
   * выгрузки отчетов.
7. **Экспорт**: Backend формирует CSV/XLSX и отправляет администратору.

*(Опционально: Redis/Celery используется для асинхронной обработки уведомлений и больших объёмов голосов.)*

---

## 4. Диаграмма архитектуры

```
+----------------+         +----------------+         +-----------------+
|  Telegram/Web  | <-----> |   Frontend     | <-----> |    Backend      |
|    Mini App    |         |  Vue 3/Tailwind|         |  Flask/FastAPI  |
+----------------+         +----------------+         +-----------------+
                                                          |
                                                          |
                                                    +-----------------+
                                                    |   SQLite DB     |
                                                    +-----------------+
                                                          |
                                                          |
                                                    +-----------------+
                                                    |  Redis / Queue  |
                                                    +-----------------+
```

---

## 5. Ключевые принципы архитектуры

1. **Клиент-серверная структура:** фронтенд и бэкенд разделены для лёгкой поддержки и масштабирования.
2. **REST API:** все операции между фронтендом и бэкендом проходят через безопасный API.
3. **Безопасность:** HTTP, проверка подписи Telegram, разграничение ролей.
4. **Отказоустойчивость:** резервное копирование базы данных и логирование всех действий.

---

## 6. Технологические заметки

* **Telegram Mini App** используется для упрощённого голосования с телефона, с минимальным UI и быстрым доступом.
* **Frontend** реализуется на Vue 3 для общего веб-интерфейса и панели администратора.
* **Backend** хранит всю логику и обрабатывает данные голосования.
* **База данных** SQLite обеспечивает консистентность и сохранность данных.
* **CI/CD** гарантирует стабильный выпуск обновлений и автоматическое тестирование.

---

