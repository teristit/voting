# –°–∏—Å—Ç–µ–º–∞ "–£–º–Ω–∞—è –ü—Ä–µ–º–∏—è"

–°–∏—Å—Ç–µ–º–∞ –¥–ª—è –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ–≥–æ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º –±–æ–Ω—É—Å–æ–≤, –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å Telegram Mini App.

## –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- **Frontend**: Vue.js 3 + Telegram WebApp SDK + TailwindCSS
- **Backend**: Python 3.11 + Flask + SQLAlchemy
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: PostgreSQL 15 (–ø—Ä–æ–¥–∞–∫—à–Ω) / SQLite (—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)
- **–ö—ç—à**: Redis
- **–û—á–µ—Ä–µ–¥–∏**: Celery + Redis

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üó≥Ô∏è **–ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ**: –û—Ü–µ–Ω–∫–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –ø–æ —à–∫–∞–ª–µ 0-10
- üìä **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞**: –†–∞—Å—á–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ –∞–ª–≥–æ—Ä–∏—Ç–º—É T1-T4
- üí∞ **–ë–æ–Ω—É—Å—ã**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ–¥–µ–ª—å–Ω–æ–≥–æ –±–æ–Ω—É—Å–∞
- üìÅ **–≠–∫—Å–ø–æ—Ä—Ç**: –û—Ç—á–µ—Ç—ã –≤ Excel/CSV –¥–ª—è –±—É—Ö–≥–∞–ª—Ç–µ—Ä–∏–∏
- üîê **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram
- üîß **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å —Å–µ—Å—Å–∏–π –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Docker –∏ Docker Compose
- –ò–ª–∏ –ª–æ–∫–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞: Python 3.11+, Node.js 18+, PostgreSQL 15+

### –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker Compose (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ)

1. **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:**
```bash
git clone https://github.com/teristit/voting.git
cd voting
```

2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
```bash
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Ñ–∞–π–ª
```

3. **–ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤:**
```bash
docker-compose up -d
```

4. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:**
```bash
docker-compose exec backend flask db upgrade
docker-compose exec backend python -c "from app import create_app; from models import *; app = create_app(); app.app_context().push(); db.create_all()"
```

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

#### Backend

```bash
cd backend
python -m venv venv
source venv/bin/activate  # –∏–ª–∏ venv\Scripts\activate –Ω–∞ Windows
pip install -r requirements.txt

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
export FLASK_ENV=development
export DATABASE_URL=sqlite:///smart_bonus.db  # –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

# –ó–∞–ø—É—Å–∫
python app.py
```

#### Frontend

```bash
cd frontend
npm install
npm run dev
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```env
# –û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
FLASK_ENV=production
SECRET_KEY=your-secret-key-here
JWT_SECRET_KEY=your-jwt-secret-key

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
DATABASE_URL=postgresql://user:password@localhost:5432/smart_bonus

# Telegram
TELEGRAM_BOT_TOKEN=your-bot-token
VITE_TELEGRAM_BOT_USERNAME=your_bot_username

# Redis –∏ Celery
CELERY_BROKER_URL=redis://localhost:6379/0
CELERY_RESULT_BACKEND=redis://localhost:6379/0

# CORS
CORS_ORIGINS=https://your-domain.com
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram Bot

1. –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ [@BotFather](https://t.me/botfather)
2. –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –∏ —É–∫–∞–∂–∏—Ç–µ –≤ `TELEGRAM_BOT_TOKEN`
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Web App —á–µ—Ä–µ–∑ BotFather:
   - `/newapp`
   - –í—ã–±–µ—Ä–∏—Ç–µ –±–æ—Ç–∞
   - –£–∫–∞–∂–∏—Ç–µ URL –≤–∞—à–µ–≥–æ frontend–∞

## API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

- `POST /api/v1/auth/telegram` - –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- `GET /api/v1/sessions/current` - –¢–µ–∫—É—â–∞—è —Å–µ—Å—Å–∏—è
- `POST /api/v1/votes` - –û—Ç–ø—Ä–∞–≤–∫–∞ –≥–æ–ª–æ—Å–æ–≤
- `GET /api/v1/results/me` - –ú–æ–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- `GET /api/v1/results/session/{id}` - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–µ—Å—Å–∏–∏

–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø–∞–ø–∫–µ `docs/`.

## –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

```bash
# –ß–µ—Ä–µ–∑ Docker
docker-compose exec backend python -c "
from app import create_app
from models.user import User
from extensions import db
app = create_app()
with app.app_context():
    admin = User(
        name='–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä',
        telegram_id=YOUR_TELEGRAM_ID,
        telegram_username='your_username',
        role='admin',
        active=True
    )
    db.session.add(admin)
    db.session.commit()
    print(f'Admin created: {admin.user_id}')
"

# –õ–æ–∫–∞–ª—å–Ω–æ
python -c "...—Ç–æ—Ç –∂–µ –∫–æ–¥..."
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f backend

# –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏
docker-compose exec db pg_dump -U smart_bonus_user smart_bonus > backup.sql

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏
docker-compose exec -i db psql -U smart_bonus_user smart_bonus < backup.sql

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
git pull
docker-compose build
docker-compose up -d
```

## –ü—Ä–æ–¥–∞–∫—à–Ω —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### SSL/HTTPS

–î–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω–∞ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Nginx —Å SSL:

```bash
# –ó–∞–ø—É—Å–∫ —Å Nginx
docker-compose --profile production up -d
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

- –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: `docker-compose logs`
- –ú–µ—Ç—Ä–∏–∫–∏ PostgreSQL: `pg_stat_activity`
- –ú–µ—Ç—Ä–∏–∫–∏ Redis: `redis-cli info`

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
voting/
‚îú‚îÄ‚îÄ backend/                 # Flask API
‚îÇ   ‚îú‚îÄ‚îÄ models/              # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ routes/              # API –º–∞—Ä—à—Ä—É—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ services/            # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ utils/               # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ tests/               # –¢–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ frontend/                # Vue.js –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/      # Vue –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ views/           # –°—Ç—Ä–∞–Ω–∏—Ü—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ services/        # API –∫–ª–∏–µ–Ω—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ public/
‚îú‚îÄ‚îÄ docs/                    # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ docker-compose.yml       # Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îî‚îÄ‚îÄ README.md
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# Backend —Ç–µ—Å—Ç—ã
cd backend
pytest

# Frontend —Ç–µ—Å—Ç—ã
cd frontend
npm run test
```

### –ö–æ–Ω—Ç—Ä–∏–±—å—é—Ç–∏–Ω–≥

1. –°–æ–∑–¥–∞–π—Ç–µ –≤–µ—Ç–∫—É –¥–ª—è –≤–∞—à–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã
3. –°–æ–∑–¥–∞–π—Ç–µ Pull Request

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: [docs/](./docs/)
- **Issues**: [GitHub Issues](https://github.com/teristit/voting/issues)
- **–ö–æ–Ω—Ç–∞–∫—Ç—ã**: dimitri.alexandr5w@yandex.ru

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - —Å–º. [LICENSE](LICENSE)
